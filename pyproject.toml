[project]
name = "cityseer"
dynamic = ["version"]
description = "Computational tools for network-based pedestrian-scale urban analysis"
readme = "README.md"
requires-python = ">=3.9, <3.11"
license = { text = "AGPL-3.0" }
keywords = [
    "network-topology",
    "numpy",
    "architecture",
    "openstreetmap",
    "urban-planning",
    "python3",
    "networkx",
    "networks",
    "spatial-analysis",
    "geographical-information-system",
    "spatial-data",
    "morphometrics",
    "network-analysis",
    "momepy",
    "numba",
    "spatial-data-analysis",
    "centrality",
    "shapely",
    "landuse",
    "osmnx",
    "network-centralities",
]
authors = [{ name = "Gareth Simons", email = "info@benchmarkurbanism.com" }]
maintainers = [{ name = "Gareth Simons", email = "info@benchmarkurbanism.com" }]
classifiers = ["Programming Language :: Python :: 3"]
dependencies = [
    "matplotlib>=3.5.1",
    "networkx>=2.7.1",
    "numba>=0.55.1",
    "numpy>=1.21.5",
    "pyproj>=3.3.0",
    "requests>=2.27.1",
    "scikit-learn>=1.0.2",
    "tqdm>=4.63.1",
    "numba-progress>=0.0.2",
    "utm>=0.7.0",
    "shapely>=1.8.1.post1",
]

[project.optional-dependencies]
[tool.pdm.dev-dependencies]
dev = [
    "pytest>=7.1.1",
    "osmnx>=1.1.2",
    "momepy>=0.5.2",
    "yapper>=0.2.1",
    "setuptools-scm>=6.4.2",
    "jupyter>=1.0.0",
    "pre-commit>=2.18.1",
    "mypy>=0.950",
    "pylint>=2.13.7",
    "black>=22.3.0",
    "isort>=5.10.1",
    "pydocstyle>=6.1.1",
    "types-requests>=2.27.25",
]

[project.urls]
homepage = "https://cityseer.benchmarkurbanism.com/"
documentation = "https://cityseer.benchmarkurbanism.com/"
repository = "https://github.com/benchmark-urbanism/cityseer-api"

[build-system]
requires = ["setuptools", "setuptools-scm"]
build-backend = "setuptools.build_meta"

[tool.setuptools]
packages = ["cityseer"]

[tool.setuptools_scm]
write_to = "cityseer/_version.py"

[tool.pdm.scripts]
build_docs = "pdm run yapper --config=./docs/.yap_config.yaml"
docs_dev = { shell = "pdm run build_docs && pnpm --prefix ./docs dev" }
docs_build = { shell = "pdm run build_docs && pnpm --prefix ./docs build" }
docs_preview = { shell = "pdm run build_docs && pnpm --prefix ./docs preview" }
lint = "prospector --profile=prospector_profile.yaml"
tests = "pytest ./tests"
build = { shell = "pdm run lint && pdm run tests && python -m build" }
publish = { shell = "pdm run build && pdm run build_docs && pdm publish -u shongololo -v" }

[tool.black]
line-length = 120

[tool.pylint.master]
disable = ["missing-module-docstring", "pointless-string-statement"]
jobs = 0
output-format = "colorized"

[tool.pylint.basic]
good-names = [
    "i",
    "j",
    "k",
    "ex",
    "Run",
    "_",
    "a",
    "b",
    "c",
    "d",
    "e",
    "f",
    "n",
    "m",
]

[tool.pylint.design]
max-args = 10

[tool.pylint.format]
max-line-length = 120

[tool.pyling.logging]
logging_format_style = "new"

[tool.mypy]
plugins = ["numpy.typing.mypy_plugin"]
exclude = ["__pypackages__", "build"]
namespace_packages = true
explicit_package_bases = true
python_version = "3.10"
strict_optional = false
warn_redundant_casts = true
warn_unused_ignores = true
warn_no_return = true
warn_return_any = true
warn_unreachable = true

[[tool.mypy.overrides]]
module = [
    "matplotlib",
    "matplotlib.pyplot",
    "matplotlib.collections",
    "matplotlib.colors",
    "networkx",
    "numba",
    "numba.core",
    "numba.typed",
    "numba_progress",
    "osmnx",
    "pandas",
    "pytest",
    "requests",
    "scipy.stats",
    "shapely",
    "sklearn.preprocessing",
    "tqdm.auto",
    "utm",
]
ignore_missing_imports = true

[tool.pydocstyle]
# http://www.pydocstyle.org/en/stable/error_codes.html
ignore = [
    "D100", # Missing docstring in public module
    "D104", # Missing docstring in public package
    "D200", # One-line docstring should fit on one line with quotes
    "D212", # Multi-line docstring summary should start at the first line
]

[tool.isort]
profile = "black"
skip_gitignore = true
line_length = 120
known_first_party = ["cityseer"]
atomic = true
filter_files = true
src_paths = ["cityseer", "demos", "test"]

[tool.pytest.ini_options]
log_cli = true
log_cli_level = "INFO"
